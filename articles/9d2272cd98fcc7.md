---
title: "JavaScript: ã‚ã¨ã‹ã‚‰å€‹åˆ¥ã« `await` ã™ã‚‹ã“ã¨ã§ä¸¦åˆ—åŒ–ã—ã‚ˆã†ã¨ã—ã¦ã¯ã„ã‘ãªã„"
emoji: "ğŸ£"
type: "idea" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["javascript", "concurrent", "parallel"]
published: false
---

## TL;DR

- ä¸¦åˆ—åŒ–ã™ã‚‹ã¨ãã¯ [`Promise.all(...)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all) ã‚’ä½¿ã„ã¾ã™ã€‚
- è¤‡æ•°ã® Promise ã‚’å–ã‚Šæ‰±ã†ã¨ãã¯ä¸Šè¨˜å«ã‚ãŸã€ [`.race(...)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race), [`.any(...)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/race), [`.allSettled(...)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled) ã®ä½¿ç”¨ã‚’æ¤œè¨ã—ã¾ã™ã€‚

## è§£èª¬

ä»¥ä¸‹ã¯ Deno ã¨ Node ã§å‹•ã‹ã—ã¦è©¦ã›ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

```js
// å®Ÿéš›ã«ã¯ API å©ã„ãŸã‚Šã¨ã‹
const get = async (a, b) => new Promise(r => setTimeout(() => r(a + b), 100));
// å®Ÿéš›ã«ã¯ä¾‹å¤–ãŒæŠ•ã’ã‚‰ã‚Œã†ã‚‹å‡¦ç†
const err = async () => {throw new Error('err')};
// ã“ã‚Œã§ã‚‚ã„ã„
// const err = async () => new Promise((_, j) => setTimeout(() => j(new Error("err")), 0));

async function main () {
  const prom1 = get(1, 2);
  const prom2 = err();
  const prom3 = get(2, 3);

  // ä¸¦åˆ—åŒ–ã—ã¦ã„ã‚‹
  await prom1;
  await prom2;
  await prom3;
}

try {
  await main();
} catch (e) {
  console.log('catch!', e);
}
```

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Node ã§ã¯ `UnhandledPromiseRejectionWarning`, Deno ã§ã¯ `Uncaught (in promise) Error:` ã¨ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã¯ `prom1` ã‚’ `await` ã—ã¦ã„ã‚‹é–“ã« `prom2` ãŒä¾‹å¤–ã‚’æŠ•ã’ã¦ _Rejected_ ã«ç§»è¡Œã—ã¾ã™ãŒã€

## çµŒç·¯


